import inspect\nfrom typing import Annotated, Callable, Dict, Any, get_origin, Type, Union, Optional, List, get_args\nfrom typing_extensions import TypeGuard\nimport copy\nimport pydantic as pd\nfrom pydantic import BaseModel, ValidationError\nfrom pydantic_core import PydanticUndefined\nfrom pprint import pprint\nimport sys\n\nclass LLMFunction:\n    def __init__(self, func, schema=None, name=None, description=None, strict=False):\n        self.func = func\n        self.name = name if name else func.__name__\n        self.description = description if description else func.__doc__\n        self.module = func.__module__\n        self.strict = strict\n        self.schema = schema if schema else get_function_schema(func, strict=strict)\n        if schema and (name or description):\n            raise ValueError("Cannot specify name or description when providing a complete schema")\n        if name:\n            self.schema['name'] = name\n        if description:\n            self.schema['description'] = description\n    \\ndef __call__(self, *args, **kwargs):\n        return self.func(*args, **kwargs)\ndef tool_def(function_schema: dict) -> dict:\n    return {\